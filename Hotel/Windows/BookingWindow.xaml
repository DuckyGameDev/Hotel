<Window x:Class="Hotel.Windows.BookingWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Hotel.Windows"
        xmlns:controls="clr-namespace:System.Windows.Controls;assembly=PresentationFramework"
        xmlns:sys="clr-namespace:System;assembly=netstandard"
        mc:Ignorable="d"
        Title="Оформление бронирования" 
        Height="710" 
        Width="900"
        WindowStartupLocation="CenterScreen">
    <Grid Background="#FFF0F5FF">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Левая часть - информация о номере -->
        <Border Grid.Column="0" Margin="10" Background="White" CornerRadius="5">
            <StackPanel Margin="10">
                <GroupBox Header="Информация о номере">
                    <StackPanel>
                        <Border BorderBrush="#FF4A6FAE" BorderThickness="1" Margin="0,0,0,10" 
                                HorizontalAlignment="Center" Width="300" Height="200">
                            <Image Source="/Images/avatar.png" Stretch="UniformToFill"/>
                        </Border>

                        <TextBlock Text="{Binding Room.RoomNumber, StringFormat='Номер: {0}'}" 
                                   FontWeight="Bold" FontSize="14" Margin="0,5"/>
                        <TextBlock Text="{Binding Room.Category.CategoryName, StringFormat='Категория: {0}'}" 
                                   Margin="0,5"/>
                        <TextBlock Text="{Binding Room.Category.Description}" 
                                   TextWrapping="Wrap" Margin="0,5"/>
                        <TextBlock Text="{Binding Room.Category.PricePerNight, StringFormat='Цена за ночь: {0:C}'}" 
                                   FontWeight="Bold" Margin="0,5"/>

                        <TextBlock Text="Даты бронирования:" FontWeight="Bold" Margin="0,10,0,5"/>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="{Binding CheckInDate, StringFormat='Заезд: {0:dd.MM.yyyy}'}" 
                                       Margin="0,0,10,0"/>
                            <TextBlock Text="{Binding CheckOutDate, StringFormat='Выезд: {0:dd.MM.yyyy}'}"/>
                        </StackPanel>

                        <TextBlock Text="{Binding TotalPrice, StringFormat='Итого: {0:C}'}" 
                                   FontWeight="Bold" FontSize="16" Margin="0,10" Foreground="#FF4A6FAE"/>
                    </StackPanel>
                </GroupBox>
            </StackPanel>
        </Border>

        <!-- Правая часть - данные для бронирования -->
        <ScrollViewer Grid.Column="1" VerticalScrollBarVisibility="Auto" Margin="10">
            <StackPanel>
                <!-- Данные гостя -->
                <GroupBox Header="Данные гостя" Margin="0,0,0,10">
                    <StackPanel>
                        <TextBlock Text="ФИО:" Margin="0,5,0,0"/>
                        <TextBox x:Name="FullNameTextBox" Text="{Binding GuestFullName}" Margin="0,0,0,10"/>

                        <TextBlock Text="Паспортные данные:"/>
                        <TextBox x:Name="PassportTextBox" Text="{Binding GuestPassport}" Margin="0,0,0,10"/>

                        <TextBlock Text="Контактный телефон:"/>
                        <TextBox x:Name="PhoneTextBox" Text="{Binding GuestPhone}" Margin="0,0,0,10"/>

                        <TextBlock Text="Email (необязательно):"/>
                        <TextBox x:Name="EmailTextBox" Text="{Binding GuestEmail}" Margin="0,0,0,10"/>
                    </StackPanel>
                </GroupBox>

                <!-- Даты бронирования -->
                <GroupBox Header="Даты бронирования" Margin="0,0,0,10">
                    <StackPanel>
                        <TextBlock Text="Дата заезда:" Margin="0,5,0,0"/>
                        <DatePicker x:Name="CheckInDatePicker" SelectedDate="{Binding CheckInDate}" 
                                    Margin="0,0,0,10" DisplayDateStart="{x:Static sys:DateTime.Today}"/>

                        <TextBlock Text="Дата выезда:"/>
                        <DatePicker x:Name="CheckOutDatePicker" SelectedDate="{Binding CheckOutDate}" 
                                    DisplayDateStart="{Binding ElementName=CheckInDatePicker, Path=SelectedDate}"/>
                    </StackPanel>
                </GroupBox>

                <!-- Дополнительные услуги -->
                <GroupBox Header="Дополнительные услуги" Margin="0,0,0,10">
                    <StackPanel>
                        <DataGrid x:Name="ServicesDataGrid" 
                                 AutoGenerateColumns="False"
                                 CanUserAddRows="False"
                                 CanUserDeleteRows="False"
                                 IsReadOnly="True"
                                 SelectionMode="Single"
                                 Margin="0,10,0,0"
                                 Height="200">
                            <DataGrid.Columns>
                                <DataGridTemplateColumn Width="Auto">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <CheckBox IsChecked="{Binding IsSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                     VerticalAlignment="Center"
                                                     HorizontalAlignment="Center"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTextColumn Header="Услуга" Binding="{Binding Service.ServiceName}" Width="*"/>
                                <DataGridTextColumn Header="Цена" Binding="{Binding Service.Price, StringFormat='{}{0:C}'}" Width="100"/>
                                <DataGridTemplateColumn Header="Дата" Width="150">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <DatePicker SelectedDate="{Binding ServiceDate, UpdateSourceTrigger=PropertyChanged}"
                                                        IsEnabled="{Binding IsSelected}"
                                                        Width="120"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Время" Width="150">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <ComboBox SelectedValue="{Binding ServiceTime, UpdateSourceTrigger=PropertyChanged}"
                                                     IsEnabled="{Binding IsSelected}"
                                                     ItemsSource="{Binding AvailableTimes}"
                                                     DisplayMemberPath="Value"
                                                     SelectedValuePath="Key"
                                                     Width="100"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                </GroupBox>

                <!-- Кнопки -->
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,15,0,0">
                    <Button Content="Подтвердить" Width="120" Margin="0,0,10,0" 
                            Click="ConfirmBooking_Click" Background="#FF4A6FAE" Foreground="White"/>
                    <Button Content="Отмена" Width="120" Click="Cancel_Click"/>
                </StackPanel>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</Window>